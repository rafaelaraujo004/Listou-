<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <link rel="apple-touch-startup-image" href="/icons/icon-maskable-512x512.png">
  <meta name="apple-mobile-web-app-title" content="Listou">
  <meta name="application-name" content="Listou">
  <meta charset="UTF-8" />
  <!-- Viewport √∫nico para impedir zoom autom√°tico em inputs -->
  <!-- Mantido user-scalable=no e maximum-scale=1 para evitar pinch/double-tap zoom; considerar acessibilidade antes de alterar -->
  <title>Listou ‚Äî Lista de Compras Inteligente</title>
  <link rel="icon" href="./√çcone de lista de compras.png" type="image/png">
  <link rel="preload" as="image" href="./√çcone de lista de compras.png">
  <meta name="theme-color" content="#0f172a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="format-detection" content="telephone=no">
  <meta name="msapplication-tap-highlight" content="no">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="./styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://unpkg.com/@zxing/browser@latest"></script>
  <link rel="manifest" href="manifest.json">
</head>
<body class="min-h-screen text-slate-100 flex animate-fadein">
<style>
@keyframes fadein {
  from { opacity: 0; }
  to { opacity: 1; }
}
.animate-fadein {
  animation: fadein 0.7s;
}
</style>
  <!-- Sidebar -->
  <aside id="sidebar" class="w-72 max-w-full glass border-r p-5 space-y-5 hidden md:block elev">
  <!-- Bot√£o fechar sidebar mobile -->
  <button id="closeSidebar" class="close-sidebar-btn absolute top-3 left-3 md:hidden hidden" aria-label="Fechar menu">‚úï</button>
    <div class="flex flex-col items-center justify-center gap-3 mb-3 mt-2" style="min-height:70px;">
      <h2 class="text-2xl font-bold text-center w-full flex items-center justify-center tracking-tight" style="height:44px;letter-spacing:-0.02em;">Listou</h2>
      <span class="text-xs muted font-medium" id="appVersion"></span>
    </div>
    <nav class="flex flex-col gap-2 w-full mt-3">
  <button class="tab-btn px-4 py-3 rounded-xl bg-white/5 hover:bg-white/10 text-left w-full font-medium text-sm transition-all" data-tab="lista"><span class="icon-svg icon-blue" aria-label="Lista"> <svg width="22" height="22" viewBox="0 0 20 20" fill="#2196F3" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="4" width="14" height="2" rx="1"/><rect x="3" y="9" width="14" height="2" rx="1"/><rect x="3" y="14" width="14" height="2" rx="1"/></svg> </span> Lista</button>
  <button class="tab-btn px-4 py-3 rounded-xl bg-white/5 hover:bg-white/10 text-left w-full font-medium text-sm transition-all" data-tab="insights"><span class="icon-svg icon-green" aria-label="Insights"> <svg width="22" height="22" viewBox="0 0 20 20" fill="#2ECC71" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="13" width="2" height="4" rx="1"/><rect x="8" y="9" width="2" height="8" rx="1"/><rect x="13" y="5" width="2" height="12" rx="1"/></svg> </span> Insights</button>
  <button class="tab-btn px-4 py-3 rounded-xl bg-white/5 hover:bg-white/10 text-left w-full font-medium text-sm transition-all" data-tab="relatorios"><span class="icon-svg icon-orange" aria-label="Relat√≥rios"> <svg width="22" height="22" viewBox="0 0 20 20" fill="#FF9800" xmlns="http://www.w3.org/2000/svg"><polyline points="3,17 8,10 13,14 17,5" stroke="#FF9800" stroke-width="2" fill="none"/></svg> </span> Relat√≥rios</button>
  <button class="tab-btn px-4 py-3 rounded-xl bg-white/5 hover:bg-white/10 text-left w-full font-medium text-sm transition-all" data-tab="sugestoes"><span class="icon-svg icon-purple" aria-label="Sugest√µes & Listas"> <svg width="22" height="22" viewBox="0 0 20 20" fill="#9C27B0" xmlns="http://www.w3.org/2000/svg"><circle cx="10" cy="10" r="7" fill="#9C27B0"/><rect x="9" y="5" width="2" height="6" fill="#fff"/><rect x="9" y="12" width="2" height="3" fill="#fff"/></svg> </span> Sugest√µes & Listas</button>
  <button class="tab-btn px-4 py-3 rounded-xl bg-white/5 hover:bg-white/10 text-left w-full font-medium text-sm transition-all" data-tab="config"><span class="icon-svg icon-gray" aria-label="Configura√ß√£o"> <svg width="22" height="22" viewBox="0 0 20 20" fill="#455A64" xmlns="http://www.w3.org/2000/svg"><circle cx="10" cy="10" r="3" fill="#455A64"/><path d="M10 2v2M10 16v2M4.22 4.22l1.42 1.42M14.36 14.36l1.42 1.42M2 10h2M16 10h2M4.22 15.78l1.42-1.42M14.36 5.64l1.42-1.42" stroke="#455A64" stroke-width="1.5"/></svg> </span> Config</button>
  <button class="tab-btn px-4 py-3 rounded-xl bg-white/5 hover:bg-white/10 text-left w-full font-medium text-sm transition-all" data-tab="historico"><span class="icon-svg icon-yellow" aria-label="Hist√≥rico"> <svg width="22" height="22" viewBox="0 0 20 20" fill="#FFD600" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a8 8 0 1 0 8 8h-2a6 6 0 1 1-6-6V2z"/></svg> </span> Hist√≥rico</button>
    </nav>
    <div id="sidebarFooter" class="mt-auto pt-6 border-t flex flex-col items-center gap-2" style="border-color:var(--ring)">
      <div class="text-xs muted font-medium">Vers√£o: <span id="appVersionSide">1.0.50</span></div>
      <div class="text-xs muted">Desenvolvido por <strong class="font-semibold">Rafael Ara√∫jo</strong></div>
    </div>
  </aside>

  <!-- Main -->
  <main class="flex-1 p-4 md:p-6 overflow-y-auto w-full">
    <!-- Se√ß√£o de Hist√≥rico (fora da sidebar) -->
    <section id="tab-historico" class="tab-section hidden space-y-4">
      <h2 class="text-2xl font-bold mb-2">Hist√≥rico de Compras</h2>
      <ul id="historicoList" class="space-y-2 max-h-96 overflow-y-auto"></ul>
      <div id="historicoVazio" class="text-xs muted">Nenhum hist√≥rico salvo ainda.</div>
    </section>
    <!-- Mobile top bar -->
    <div class="md:hidden mb-4 flex items-center gap-2">
      <button id="toggleSidebar" class="hamburger-btn px-2 py-1 rounded-md bg-white/10 text-lg">‚ò∞</button>
      <div class="flex-1"></div>
      <div class="ml-auto flex items-center gap-2">
        <button id="themeToggle" class="px-3 py-2 rounded-lg bg-white/10 text-xs flex items-center justify-center" aria-label="Alternar tema">
          <svg id="themeIcon" width="20" height="20" viewBox="0 0 24 24" class="transition-transform duration-300 ease-out">
            <g id="icon-sun">
              <circle cx="12" cy="12" r="4" />
              <g>
                <line x1="12" y1="1" x2="12" y2="4" />
                <line x1="12" y1="20" x2="12" y2="23" />
                <line x1="1" y1="12" x2="4" y2="12" />
                <line x1="20" y1="12" x2="23" y2="12" />
                <line x1="4.2" y1="4.2" x2="6.3" y2="6.3" />
                <line x1="17.7" y1="17.7" x2="19.8" y2="19.8" />
                <line x1="4.2" y1="19.8" x2="6.3" y2="17.7" />
                <line x1="17.7" y1="6.3" x2="19.8" y2="4.2" />
              </g>
            </g>
            <g id="icon-moon">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </g>
          </svg>
        </button>
        <div class="text-[11px] muted" id="appVersionTop"></div>
      </div>
    </div>

    <!-- LISTA -->
    <section id="tab-lista" class="tab-section space-y-4">
      <!-- Logo e Nome Centralizados -->
      <div class="flex flex-col items-center justify-center gap-3 mb-4">
        <svg width="80" height="80" viewBox="0 0 128 128" aria-label="Logo Listou" style="min-width:80px;min-height:80px;">
          <rect x="0" y="0" width="128" height="128" rx="28" fill="#60a5fa"/>
          <rect x="40" y="32" width="48" height="64" rx="6" fill="#f8fafc"/>
          <rect x="58" y="28" width="12" height="8" rx="2" fill="#64748b" opacity="0.7"/>
          <rect x="60" y="30" width="8" height="4" rx="1" fill="#94a3b8" opacity="0.8"/>
          <rect x="44" y="40" width="40" height="52" rx="3" fill="#fff"/>
          <circle cx="50" cy="50" r="4" fill="#34d399"/>
          <path d="M48 50 L49.5 51.5 L52 49" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round"/>
          <rect x="58" y="48" width="20" height="2" rx="1" fill="#94a3b8" opacity="0.4"/>
          <circle cx="50" cy="62" r="4" fill="#34d399"/>
          <path d="M48 62 L49.5 63.5 L52 61" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round"/>
          <rect x="58" y="60" width="18" height="2" rx="1" fill="#94a3b8" opacity="0.4"/>
          <circle cx="50" cy="74" r="4" fill="#e2e8f0" stroke="#cbd5e1" stroke-width="1"/>
          <rect x="58" y="72" width="16" height="2" rx="1" fill="#64748b" opacity="0.6"/>
          <circle cx="50" cy="86" r="4" fill="#34d399"/>
          <path d="M48 86 L49.5 87.5 L52 85" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round"/>
          <rect x="58" y="84" width="22" height="2" rx="1" fill="#94a3b8" opacity="0.4"/>
        </svg>
        <h1 class="text-3xl font-bold text-center" style="letter-spacing:-0.02em;">Listou</h1>
        <p class="text-lg font-medium text-center opacity-80">Sua lista de compras Inteligente üß†</p>
      </div>
      <div style="width:100%;max-width:120px;height:4px;margin:0 auto 18px auto;position:relative;">
        <div style="width:100%;height:4px;border-radius:2px;background:linear-gradient(90deg,#2563eb,#60a5fa);position:absolute;left:0;top:0;animation:underlineFadeIn 1.2s cubic-bezier(.4,0,.2,1);"></div>
      </div>
      <style>
        @keyframes underlineFadeIn {
          from { width: 0; opacity: 0; }
          to { width: 100%; opacity: 1; }
        }
      </style>

      <!-- Market & KPI cards -->
      <div class="flex flex-wrap gap-4 items-center mt-2">
        <div class="flex items-center gap-3 text-sm">
          <label for="market" class="opacity-80 font-medium">Mercado:</label>
          <input id="market" class="px-4 py-2.5 rounded-xl bg-white/5 ring-1 font-medium" style="border-color:var(--ring)" placeholder="Ex.: Atacad√£o, Carrefour"/>
          <button id="saveMarket" class="px-4 py-2.5 rounded-xl bg-white/10 hover:bg-white/20 text-sm font-medium transition-all">Salvar</button>
        </div>
        <div class="ml-auto grid grid-cols-2 gap-4 w-full md:w-auto text-sm kpi-row">
          <div class="kpi-card"><div class="kpi-label font-medium">Valor Previsto</div><div class="kpi-value font-bold" id="kpiPrevisto">‚Äî</div></div>
          <div class="kpi-card"><div class="kpi-label font-medium">Valor Realizado</div><div class="kpi-value font-bold" id="kpiRealizado">‚Äî</div></div>
        </div>
      </div>

      <!-- Add item -->
      <div class="card rounded-2xl p-4 md:p-5">
        <form id="addForm" class="grid grid-cols-12 gap-3" autocomplete="off">
          <div class="col-span-12 md:col-span-4 relative">
            <input id="name" class="w-full px-3 py-2 rounded-xl bg-white/5 ring-1 font-medium text-sm" style="border-color:var(--ring)" placeholder="Nome do item (clique para sugest√µes)" />
            <div id="suggestions" class="absolute z-10 mt-1 w-full max-h-56 overflow-auto hidden glass rounded-xl p-2 text-sm"></div>
          </div>
          <select id="category" class="col-span-6 md:col-span-2 px-3 py-2 rounded-xl bg-white/5 ring-1 font-medium text-sm" style="border-color:var(--ring)" required>
            <option value="">Selecione...</option><option>Latic√≠nios</option><option>Hortifruti</option><option>Limpeza</option><option>Higiene</option><option>Bebidas</option><option>Carnes</option><option>Cereais</option><option>Mercearia</option><option>Outros</option>
          </select>
          <select id="unit" class="col-span-6 md:col-span-2 px-3 py-2 rounded-xl bg-white/5 ring-1 font-medium text-sm" style="border-color:var(--ring)">
            <option value="un">un</option><option value="kg">kg</option><option value="g">g</option><option value="L">L</option><option value="ml">ml</option><option value="pct">pct</option>
          </select>
          <input id="qty" type="text" pattern="[0-9.,]*" inputmode="decimal" class="col-span-6 md:col-span-2 px-3 py-2 rounded-xl bg-white/5 ring-1 font-medium text-sm" style="border-color:var(--ring)" placeholder="Qtd (padr√£o: 1)" autocomplete="off" />
          <input id="price" type="text" pattern="[0-9.,]*" inputmode="decimal" class="col-span-6 md:col-span-2 px-3 py-2 rounded-xl bg-white/5 ring-1 font-medium text-sm" style="border-color:var(--ring)" placeholder="Pre√ßo" autocomplete="off" />
          <button class="col-span-12 md:col-span-2 px-4 py-2 rounded-xl bg-blue-500 hover:bg-blue-400 font-semibold text-sm transition-all">Adicionar</button>
        </form>


      </div>

      <!-- Scanner & EAN manual -->
  <!-- Se√ß√£o de scanner removida -->

      <!-- Table -->
      <div class="card rounded-2xl p-3 md:p-4 shopping-list-area">
        <div class="flex flex-wrap items-center gap-2 mb-3">
          <span class="text-xs muted" id="count">0 itens</span>
          <select id="categoryFilter" class="px-2 py-2 rounded-xl bg-white/5 ring-1 text-xs" style="border-color:var(--ring)">
          </select>
          <div class="ml-auto flex items-center gap-2">
            <select id="sort" class="px-2 py-2 rounded-xl bg-white/5 ring-1 text-xs" style="border-color:var(--ring)">
              <option value="recent">Classificar</option>
              <option value="name">Nome (A‚ÄìZ)</option>
              <option value="price">Pre√ßo (‚Üë)</option>
              <option value="subtotal">Subtotal (‚Üë)</option>
            </select>
            <button id="copyList" class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 text-sm">Copiar Lista</button>
            <button id="finalizar" class="px-3 py-2 rounded-xl bg-blue-500 hover:bg-blue-400 text-sm">Finalizar compra</button>
            <button id="shareList" class="p-1 rounded-full bg-green-600 hover:bg-green-700 flex items-center justify-center" style="min-width:24px;min-height:24px;width:24px;height:24px;" title="Compartilhar lista">
              <svg width="14" height="14" fill="none" viewBox="0 0 24 24" aria-label="Compartilhar"><path d="M18 8a3 3 0 1 0-2.83-4A3 3 0 0 0 18 8zm-12 8a3 3 0 1 0 2.83 4A3 3 0 0 0 6 16zm12 0a3 3 0 1 0 2.83 4A3 3 0 0 0 18 16zm-9.17-2.41l7.34-3.18m-7.34 3.18l7.34 3.18" stroke="#fff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
          </div>
        </div>
  <!-- Sugest√µes inteligentes (leitura de pensamento) -->
  <div id="mindReadingSuggestions"></div>
  <div id="list" class="grid gap-2 grid-cols-1"></div>
  <!-- Caixa de 'Total Geral' removida conforme solicitado -->
        <div class="mt-2 text-xs muted" id="progress"></div>
      </div>
    </section>

    <!-- INSIGHTS -->
    <section id="tab-insights" class="tab-section hidden space-y-4">
      <h1 class="text-2xl font-bold">Insights</h1>
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
        <div class="card p-4"><p class="text-xs muted">Total atual</p><p id="kpiTotal" class="text-2xl font-bold">‚Äî</p></div>
        <div class="card p-4"><p class="text-xs muted">Itens</p><p id="kpiItens" class="text-2xl font-bold">‚Äî</p></div>
        <div class="card p-4"><p class="text-xs muted">Ticket m√©dio</p><p id="kpiTicket" class="text-2xl font-bold">‚Äî</p></div>
        <div class="card p-4"><p class="text-xs muted">Conclu√≠dos</p><p id="kpiDone" class="text-2xl font-bold">‚Äî</p></div>
      </div>
      <div class="grid lg:grid-cols-2 gap-6">
  <div class="card p-4"><h3 class="font-semibold mb-2">Gasto por categoria</h3><canvas id="chartCategorias" height="140"></canvas></div>
  <div class="card p-4"><h3 class="font-semibold mb-2">Curva ABC</h3><canvas id="chartABC" height="140"></canvas></div>
      </div>
    </section>

    <!-- RELAT√ìRIOS -->
    <section id="tab-relatorios" class="tab-section hidden space-y-4">
  <h1 class="text-2xl font-bold">Relat√≥rios</h1>
  <p class="muted text-sm">Atualiza automaticamente ao finalizar uma compra.</p>
  <div id="cheapestMarketBox" class="mb-4"></div>
      <div class="grid md:grid-cols-2 gap-6 mb-4">
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Comparativo de mercados</h3>
          <canvas id="chartMarketsTotal" height="140"></canvas>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Produtos mais baratos por mercado</h3>
          <div id="cheapestProductsBox"></div>
        </div>
      </div>
        <div class="card p-4">
          <div class="flex items-center gap-2 mb-2">
            <h3 class="font-semibold">Compara√ß√£o por mercado (item)</h3>
            <select id="reportItemSelect" class="ml-auto px-2 py-1 rounded bg-white/5 ring-1" style="border-color:var(--ring)"></select>
          </div>
          <canvas id="chartItemMarket" height="140"></canvas>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Ranking de varia√ß√£o (‚àÜ% √∫ltimo vs anterior)</h3>
          <canvas id="chartRankingVar" height="140"></canvas>
        </div>
  <div class="card p-4"><h3 class="font-semibold mb-2">Gastos por m√™s</h3><canvas id="chartGastosMes" height="140"></canvas></div>
  <div class="card p-4"><h3 class="font-semibold mb-2">Frequ√™ncia de itens</h3><canvas id="chartFreq" height="140"></canvas></div>
      </div>
    </section>

    <!-- SUGEST√ïES & LISTAS -->
    <section id="tab-sugestoes" class="tab-section hidden space-y-4">
<!-- Modal de edi√ß√£o de lista salva -->
<div id="editUserListModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/40 hidden">
  <div class="bg-slate-900 rounded-lg p-6 w-full max-w-lg shadow-lg relative">
    <button id="closeEditUserListModal" class="absolute top-2 right-2 text-xl px-2 py-1 rounded hover:bg-white/10">‚úï</button>
    <h2 class="text-lg font-bold mb-4">Editar itens da lista</h2>
    <div id="editUserListItemsBox" class="space-y-2 mb-4"></div>
    <button id="saveEditUserListBtn" class="px-4 py-2 rounded bg-emerald-600 hover:bg-emerald-700 text-white font-semibold">Salvar altera√ß√µes</button>
  </div>
</div>
      <h1 class="text-2xl font-bold">Sugest√µes & Listas</h1>
      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Churrasco</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"Carne","category":"Carnes","unit":"kg","qty":3},{"name":"Carv√£o","category":"Outros","unit":"kg","qty":5},{"name":"Refrigerante","category":"Bebidas","unit":"L","qty":6}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"Carne","category":"Carnes","unit":"kg","qty":3},{"name":"Carv√£o","category":"Outros","unit":"kg","qty":5},{"name":"Refrigerante","category":"Bebidas","unit":"L","qty":6}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Limpeza do m√™s</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"Detergente","category":"Limpeza","unit":"un","qty":4},{"name":"Sab√£o em p√≥","category":"Limpeza","unit":"kg","qty":2},{"name":"√Ågua sanit√°ria","category":"Limpeza","unit":"L","qty":2}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"Detergente","category":"Limpeza","unit":"un","qty":4},{"name":"Sab√£o em p√≥","category":"Limpeza","unit":"kg","qty":2},{"name":"√Ågua sanit√°ria","category":"Limpeza","unit":"L","qty":2}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Caf√© da manh√£</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"P√£o","category":"Mercearia","unit":"un","qty":10},{"name":"Leite","category":"Latic√≠nios","unit":"L","qty":2},{"name":"Caf√©","category":"Mercearia","unit":"g","qty":250},{"name":"Manteiga","category":"Latic√≠nios","unit":"un","qty":1},{"name":"Queijo","category":"Latic√≠nios","unit":"g","qty":200}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"P√£o","category":"Mercearia","unit":"un","qty":10},{"name":"Leite","category":"Latic√≠nios","unit":"L","qty":2},{"name":"Caf√©","category":"Mercearia","unit":"g","qty":250},{"name":"Manteiga","category":"Latic√≠nios","unit":"un","qty":1},{"name":"Queijo","category":"Latic√≠nios","unit":"g","qty":200}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Semana saud√°vel</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"Alface","category":"Hortifruti","unit":"un","qty":2},{"name":"Tomate","category":"Hortifruti","unit":"kg","qty":1},{"name":"Frango","category":"Carnes","unit":"kg","qty":1},{"name":"Arroz integral","category":"Mercearia","unit":"kg","qty":1},{"name":"Banana","category":"Hortifruti","unit":"un","qty":7}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"Alface","category":"Hortifruti","unit":"un","qty":2},{"name":"Tomate","category":"Hortifruti","unit":"kg","qty":1},{"name":"Frango","category":"Carnes","unit":"kg","qty":1},{"name":"Arroz integral","category":"Mercearia","unit":"kg","qty":1},{"name":"Banana","category":"Hortifruti","unit":"un","qty":7}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Volta √†s aulas</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"Biscoito","category":"Mercearia","unit":"pct","qty":3},{"name":"Suco","category":"Bebidas","unit":"L","qty":3},{"name":"Iogurte","category":"Latic√≠nios","unit":"un","qty":6},{"name":"Fruta","category":"Hortifruti","unit":"un","qty":6}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"Biscoito","category":"Mercearia","unit":"pct","qty":3},{"name":"Suco","category":"Bebidas","unit":"L","qty":3},{"name":"Iogurte","category":"Latic√≠nios","unit":"un","qty":6},{"name":"Fruta","category":"Hortifruti","unit":"un","qty":6}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Pet</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"Ra√ß√£o","category":"Outros","unit":"kg","qty":5},{"name":"Petisco","category":"Outros","unit":"un","qty":2},{"name":"Areia sanit√°ria","category":"Outros","unit":"kg","qty":4}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"Ra√ß√£o","category":"Outros","unit":"kg","qty":5},{"name":"Petisco","category":"Outros","unit":"un","qty":2},{"name":"Areia sanit√°ria","category":"Outros","unit":"kg","qty":4}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">B√°sico do m√™s</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"Arroz","category":"Mercearia","unit":"kg","qty":5},{"name":"Feij√£o","category":"Mercearia","unit":"kg","qty":2},{"name":"√ìleo","category":"Mercearia","unit":"L","qty":2},{"name":"A√ß√∫car","category":"Mercearia","unit":"kg","qty":2},{"name":"Sal","category":"Mercearia","unit":"kg","qty":1}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"Arroz","category":"Mercearia","unit":"kg","qty":5},{"name":"Feij√£o","category":"Mercearia","unit":"kg","qty":2},{"name":"√ìleo","category":"Mercearia","unit":"L","qty":2},{"name":"A√ß√∫car","category":"Mercearia","unit":"kg","qty":2},{"name":"Sal","category":"Mercearia","unit":"kg","qty":1}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Festa infantil</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"Refrigerante","category":"Bebidas","unit":"L","qty":6},{"name":"Salgadinho","category":"Mercearia","unit":"pct","qty":5},{"name":"Bolo","category":"Mercearia","unit":"kg","qty":2},{"name":"Doces","category":"Mercearia","unit":"pct","qty":4},{"name":"Copo descart√°vel","category":"Outros","unit":"pct","qty":2}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"Refrigerante","category":"Bebidas","unit":"L","qty":6},{"name":"Salgadinho","category":"Mercearia","unit":"pct","qty":5},{"name":"Bolo","category":"Mercearia","unit":"kg","qty":2},{"name":"Doces","category":"Mercearia","unit":"pct","qty":4},{"name":"Copo descart√°vel","category":"Outros","unit":"pct","qty":2}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Padaria</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"P√£o franc√™s","category":"Mercearia","unit":"un","qty":10},{"name":"P√£o de forma","category":"Mercearia","unit":"un","qty":1},{"name":"Croissant","category":"Mercearia","unit":"un","qty":6},{"name":"Bolo","category":"Mercearia","unit":"un","qty":1},{"name":"Rosca doce","category":"Mercearia","unit":"un","qty":1}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"P√£o franc√™s","category":"Mercearia","unit":"un","qty":10},{"name":"P√£o de forma","category":"Mercearia","unit":"un","qty":1},{"name":"Croissant","category":"Mercearia","unit":"un","qty":6},{"name":"Bolo","category":"Mercearia","unit":"un","qty":1},{"name":"Rosca doce","category":"Mercearia","unit":"un","qty":1}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">A√ßougue</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"Picanha","category":"Carnes","unit":"kg","qty":1},{"name":"Frango","category":"Carnes","unit":"kg","qty":2},{"name":"Costela","category":"Carnes","unit":"kg","qty":1.5},{"name":"Lingui√ßa","category":"Carnes","unit":"kg","qty":1},{"name":"Bacon","category":"Carnes","unit":"g","qty":500}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"Picanha","category":"Carnes","unit":"kg","qty":1},{"name":"Frango","category":"Carnes","unit":"kg","qty":2},{"name":"Costela","category":"Carnes","unit":"kg","qty":1.5},{"name":"Lingui√ßa","category":"Carnes","unit":"kg","qty":1},{"name":"Bacon","category":"Carnes","unit":"g","qty":500}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Marmita Fit</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"Arroz integral","category":"Cereais","unit":"kg","qty":2},{"name":"Quinoa","category":"Cereais","unit":"g","qty":500},{"name":"Batata doce","category":"Hortifruti","unit":"kg","qty":2},{"name":"Peito de frango","category":"Carnes","unit":"kg","qty":2},{"name":"Br√≥colis","category":"Hortifruti","unit":"un","qty":2},{"name":"Azeite de oliva","category":"Mercearia","unit":"ml","qty":500}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"Arroz integral","category":"Cereais","unit":"kg","qty":2},{"name":"Quinoa","category":"Cereais","unit":"g","qty":500},{"name":"Batata doce","category":"Hortifruti","unit":"kg","qty":2},{"name":"Peito de frango","category":"Carnes","unit":"kg","qty":2},{"name":"Br√≥colis","category":"Hortifruti","unit":"un","qty":2},{"name":"Azeite de oliva","category":"Mercearia","unit":"ml","qty":500}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Sobremesas</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"Sorvete","category":"Outros","unit":"L","qty":2},{"name":"Chocolate","category":"Mercearia","unit":"g","qty":200},{"name":"Leite condensado","category":"Latic√≠nios","unit":"un","qty":2},{"name":"Creme de leite","category":"Latic√≠nios","unit":"un","qty":2},{"name":"Morango","category":"Hortifruti","unit":"g","qty":500}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"Sorvete","category":"Outros","unit":"L","qty":2},{"name":"Chocolate","category":"Mercearia","unit":"g","qty":200},{"name":"Leite condensado","category":"Latic√≠nios","unit":"un","qty":2},{"name":"Creme de leite","category":"Latic√≠nios","unit":"un","qty":2},{"name":"Morango","category":"Hortifruti","unit":"g","qty":500}]'>Editar</button>
          </div>
        </div>
        <div class="card p-4">
          <h3 class="font-semibold mb-2">Frutas da Semana</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button class="tpl px-3 py-1 rounded-full bg-white/10" data-template='[{"name":"Banana","category":"Hortifruti","unit":"un","qty":12},{"name":"Ma√ß√£","category":"Hortifruti","unit":"un","qty":6},{"name":"Laranja","category":"Hortifruti","unit":"kg","qty":2},{"name":"Mam√£o","category":"Hortifruti","unit":"un","qty":1},{"name":"Melancia","category":"Hortifruti","unit":"un","qty":1},{"name":"Uva","category":"Hortifruti","unit":"g","qty":500}]'>Adicionar</button>
            <button class="edit-tpl px-3 py-1 rounded-full bg-blue-600 hover:bg-blue-500" data-template='[{"name":"Banana","category":"Hortifruti","unit":"un","qty":12},{"name":"Ma√ß√£","category":"Hortifruti","unit":"un","qty":6},{"name":"Laranja","category":"Hortifruti","unit":"kg","qty":2},{"name":"Mam√£o","category":"Hortifruti","unit":"un","qty":1},{"name":"Melancia","category":"Hortifruti","unit":"un","qty":1},{"name":"Uva","category":"Hortifruti","unit":"g","qty":500}]'>Editar</button>
          </div>
        </div>
      </div>
      <div class="card p-4">
        <div class="flex items-center justify-between mb-2">
          <h3 class="font-semibold">Minhas listas</h3>
          <div class="flex gap-2">
            <!-- Bot√£o 'Salvar lista atual' removido -->
          </div>
        </div>
        <div id="userLists" class="flex flex-col gap-2"></div>
      </div>
    </section>

    <!-- CONFIG -->
    <section id="tab-config" class="tab-section hidden space-y-4">
      <h1 class="text-2xl font-bold">Configura√ß√µes</h1>
  <button id="clearAllData" class="px-3 py-2 rounded-lg bg-rose-600/80 hover:bg-rose-600 text-white text-sm mt-2">Remover todos os dados do usu√°rio</button>
      <div class="flex items-center gap-2">
        <label class="text-sm">Tema:</label>
        <button id="themeToggle2" class="px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-sm flex items-center gap-2">
          <svg width="18" height="18" viewBox="0 0 24 24" class="transition-transform duration-300 ease-out"><circle cx="12" cy="12" r="4"/></svg>
          Alternar claro/escuro
        </button>
        <span class="text-xs muted" id="themeLabel">‚Äî</span>
      </div>
        <div class="flex gap-2 mt-2">
        <a href="https://instagram.com/listou.app" target="_blank" title="Instagram" class="hover:underline text-xs flex items-center gap-1">
          <svg width="16" height="16" viewBox="0 0 448 512" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="448" height="512" rx="100" fill="url(#ig-gradient)"/><defs><linearGradient id="ig-gradient" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#f9ce34"/><stop offset="50%" stop-color="#ee2a7b"/><stop offset="100%" stop-color="#6228d7"/></linearGradient></defs><circle cx="224" cy="256" r="80" stroke="#fff" stroke-width="32" fill="none"/><circle cx="336" cy="144" r="24" fill="#fff"/></svg>
          Instagram
        </a>
        <a href="mailto:listou.app@gmail.com" title="E-mail" class="hover:underline text-xs flex items-center gap-1">
          <svg width="16" height="16" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="32" height="32" rx="6" fill="#0078D4"/><path d="M8 10h16a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2zm0 2v.511l8 5.333 8-5.333V12l-8 5.333L8 12z" fill="#fff"/></svg>
          Contato
        </a>
        <a href="https://wa.me/5594984305772" target="_blank" title="WhatsApp" class="hover:underline text-xs flex items-center gap-1">
          <svg width="16" height="16" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="32" height="32" rx="6" fill="#25D366"/><path d="M16 6a10 10 0 0 0-8.66 15.07l-1.13 4.13a1 1 0 0 0 1.22 1.22l4.13-1.13A10 10 0 1 0 16 6zm5.47 13.53c-.23.65-1.34 1.28-1.84 1.36-.47.07-1.06.1-1.7-.11-.39-.13-.89-.29-1.53-.57-2.7-1.18-4.46-4.01-4.6-4.2-.13-.18-1.1-1.47-1.1-2.8 0-1.33.7-1.98.95-2.25.25-.27.55-.34.74-.34.19 0 .37.01.53.01.17 0 .4-.06.63.48.23.54.78 1.86.85 2 .07.14.12.31.02.5-.1.19-.15.31-.29.48-.14.17-.29.38-.41.51-.13.13-.26.27-.11.54.15.27.67 1.1 1.44 1.78.99.88 1.82 1.16 2.09 1.29.27.13.43.11.59-.07.16-.18.68-.79.86-1.06.18-.27.36-.22.61-.13.25.09 1.59.75 1.86.89.27.13.45.2.52.31.07.11.07.63-.16 1.28z" fill="#fff"/></svg>
          WhatsApp
        </a>
        </div>
        <div class="text-xs mt-1">
        <a href="mailto:rafaelaraujo004@gmail.com?subject=Sugest√£o%20de%20melhoria%20para%20o%20app%20Listou" class="hover:underline flex items-center gap-1">
          <svg width="16" height="16" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="32" height="32" rx="6" fill="#0078D4"/><path d="M8 10h16a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2zm0 2v.511l8 5.333 8-5.333V12l-8 5.333L8 12z" fill="#fff"/></svg>
          Sugira melhorias para o app
        </a>
        </div>
    </section>
  </main>

  <script src="./app.js"></script>
<script>
// Sistema de atualiza√ß√£o autom√°tica do app
if ('serviceWorker' in navigator) {
  let refreshing = false;
  
  // Detectar quando h√° uma atualiza√ß√£o dispon√≠vel
  navigator.serviceWorker.addEventListener('controllerchange', () => {
    if (refreshing) return;
    refreshing = true;
    console.log('[App] Nova vers√£o detectada - recarregando...');
    window.location.reload();
  });

  // Registrar service worker e verificar atualiza√ß√µes
  navigator.serviceWorker.register('./sw.js', { updateViaCache: 'none' })
    .then(reg => {
      console.log('[App] Service Worker registrado');
      
      // Verificar atualiza√ß√µes a cada 30 segundos
      setInterval(() => {
        reg.update().then(() => {
          console.log('[App] Verifica√ß√£o de atualiza√ß√£o conclu√≠da');
        });
      }, 30000);
      
      // Detectar nova vers√£o instalada
      reg.addEventListener('updatefound', () => {
        const newWorker = reg.installing;
        console.log('[App] Nova vers√£o sendo instalada...');
        
        newWorker.addEventListener('statechange', () => {
          if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
            // Nova vers√£o dispon√≠vel
            console.log('[App] Nova vers√£o instalada - preparando atualiza√ß√£o');
            
            // Mostrar notifica√ß√£o de atualiza√ß√£o
            if (confirm('Nova vers√£o do Listou dispon√≠vel! Deseja atualizar agora?')) {
              newWorker.postMessage({ type: 'SKIP_WAITING' });
            }
          }
        });
      });
    })
    .catch(err => console.error('[App] Erro ao registrar Service Worker:', err));

  // Receber mensagens do service worker
  navigator.serviceWorker.addEventListener('message', event => {
    if (event.data.type === 'SW_UPDATED') {
      console.log(`[App] Atualizado para vers√£o ${event.data.version}`);
    }
  });
}
</script>
</body>
</html>
