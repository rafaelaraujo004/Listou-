<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listou - Lista de Compras</title>
    <meta name="theme-color" content="#ffffff">
    <link rel="manifest" href="manifest.webmanifest">
                        <div class="header-actions">
                        <button id="export-png-report-btn" class="header-btn" title="Exportar como Imagem PNG">
                            üñºÔ∏è PNG
                        </button>
                        <button id="export-pdf-report-btn" class="header-btn" title="Exportar como PDF">
                            üìÑ PDF
                        </button>
                    </div>stylesheet" href="styles.css">
    <!-- Biblioteca para leitura de QRCode -->
    <script src="https://unpkg.com/jsqr@1.4.0/dist/jsQR.js"></script>
</head>
<body>
    <!-- Sidebar Toggle Button -->
    <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Abrir menu lateral">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
    </button>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <picture>
                <source srcset="logo.svg" type="image/svg+xml">
                <img src="logo.svg" alt="Logo Listou" class="sidebar-logo" width="48" height="48" loading="lazy">
            </picture>
            <h2>Listou</h2>
            <button id="sidebar-close" class="sidebar-close" aria-label="Fechar menu">√ó</button>
        </div>

        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" data-section="main">
                <span class="nav-icon">üè†</span>
                <span class="nav-text">Lista Principal</span>
            </a>
            <a href="#" class="nav-item" data-section="templates">
                <span class="nav-icon">üìã</span>
                <span class="nav-text">Templates</span>
            </a>
            <a href="#" class="nav-item" data-section="analytics">
                <span class="nav-icon">üìä</span>
                <span class="nav-text">Relat√≥rios</span>
            </a>
            <a href="#" class="nav-item" data-section="history">
                <span class="nav-icon">üìÖ</span>
                <span class="nav-text">Hist√≥rico</span>
            </a>
            <a href="#" class="nav-item" data-section="supermarkets">
                <span class="nav-icon">üè™</span>
                <span class="nav-text">Supermercados</span>
            </a>
            <a href="#" class="nav-item" data-section="settings">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-text">Configura√ß√µes</span>
            </a>
        </nav>

        <div class="sidebar-recent">
            <h3>Listas Recentes</h3>
            <div id="recent-lists" class="recent-lists">
                <div class="recent-item">
                    <span class="recent-icon">üõí</span>
                    <div class="recent-info">
                        <span class="recent-name">Compra da Semana</span>
                        <span class="recent-date">Hoje</span>
                    </div>
                </div>
                <div class="recent-item">
                    <span class="recent-icon">ü•¨</span>
                    <div class="recent-info">
                        <span class="recent-name">Feira Livre</span>
                        <span class="recent-date">Ontem</span>
                    </div>
                </div>
                <div class="recent-item">
                    <span class="recent-icon">üßΩ</span>
                    <div class="recent-info">
                        <span class="recent-name">Produtos de Limpeza</span>
                        <span class="recent-date">3 dias atr√°s</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="sidebar-actions">
            <button id="sidebar-share-btn" class="sidebar-action-btn">
                <span class="action-icon">üì§</span>
                <span class="action-text">Compartilhar</span>
            </button>
            <button id="sidebar-export-btn" class="sidebar-action-btn">
                <span class="action-icon">üìã</span>
                <span class="action-text">Exportar</span>
            </button>
            <button id="sidebar-scan-btn" class="sidebar-action-btn">
                <span class="action-icon">üì±</span>
                <span class="action-text">Escanear QR</span>
                <span class="test-badge">TESTE</span>
            </button>
        </div>
    </aside>

    <!-- Modal de Sele√ß√£o de Tipo de Compra -->
    <div id="purchase-type-modal" class="purchase-type-modal hidden">
        <div class="purchase-type-modal-content">
            <div class="purchase-type-header">
                <h2>üõí Tipo de Compra</h2>
                <p>Escolha como deseja usar sua lista de compras:</p>
            </div>
            
            <div class="purchase-type-options">
                <button class="purchase-type-option" data-type="controlled">
                    <div class="option-icon">üìä</div>
                    <div class="option-content">
                        <h3>Compra Controlada</h3>
                        <p>Os dados ser√£o utilizados para relat√≥rios, compara√ß√µes e indicadores de economia</p>
                        <ul class="option-benefits">
                            <li>‚úÖ Gera relat√≥rios detalhados</li>
                            <li>‚úÖ Compara√ß√£o entre supermercados</li>
                            <li>‚úÖ An√°lise de economia</li>
                            <li>‚úÖ Hist√≥rico de compras</li>
                        </ul>
                    </div>
                </button>
                
                <button class="purchase-type-option" data-type="casual">
                    <div class="option-icon">üõçÔ∏è</div>
                    <div class="option-content">
                        <h3>Compra Avulsa</h3>
                        <p>Lista simples sem gerar dados para relat√≥rios ou an√°lises</p>
                        <ul class="option-benefits">
                            <li>‚úÖ Lista b√°sica e r√°pida</li>
                            <li>‚úÖ Sem coleta de dados</li>
                            <li>‚úÖ Privacidade total</li>
                            <li>‚ùå Sem relat√≥rios</li>
                        </ul>
                    </div>
                </button>
            </div>
            
            <div class="purchase-type-footer">
                <small>üí° Voc√™ pode mudar o tipo de compra a qualquer momento nas configura√ß√µes</small>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main id="main-content" class="main-content">
        <!-- Main Section -->
        <section id="section-main" class="content-section active">

            <header class="section-header">
                <div class="main-header-app">
                    <picture>
                        <source srcset="logo.svg" type="image/svg+xml">
                        <img src="logo.svg" alt="Logo Listou" class="main-logo" width="64" height="64" loading="lazy">
                    </picture>
                    <span class="main-app-name">Listou</span>
                </div>
                <div class="section-title-container">
                    <div class="title-with-badge" style="display: flex; flex-direction: column; align-items: center;">
                        <img src="logo.svg" alt="Logo Listou" class="main-logo" width="64" height="64" style="margin-bottom: 8px;" loading="lazy">
                        <h1>Lista de Compras</h1>
                        <span id="purchase-type-badge" class="purchase-type-badge">üìä Controlada</span>
                        <button id="change-purchase-type-btn" class="header-btn" title="Alterar tipo de compra">üîÑ</button>
                    </div>
                    <div class="supermarket-input-container">
                        <select id="main-supermarket-select" class="supermarket-select" title="Selecione o supermercado">
                            <option value="">üìç Selecione o supermercado</option>
                        </select>
                        <small class="supermarket-hint">Para an√°lises comparativas de pre√ßos</small>
                    </div>
                </div>
            </header>

            <section id="add-item-section">
                <div class="input-container">
                    <input id="item-input" type="text" placeholder="Adicionar item... (Enter ou Ctrl+Enter)" autocomplete="off" autofocus>
                    <div id="autocomplete-list" class="autocomplete-hidden"></div>
                </div>
                <div class="input-container" style="display: flex; align-items: center; gap: 0.5rem;">
                    <input id="item-qty-input" type="number" min="1" step="1" placeholder="Qtd" style="width: 70px;">
                    <select id="item-unit-input" style="width: 80px;">
                        <option value="">Unid.</option>
                        <option value="unid">unid</option>
                        <option value="kg">kg</option>
                        <option value="g">g</option>
                        <option value="l">L</option>
                        <option value="ml">ml</option>
                        <option value="pc">pc</option>
                        <option value="cx">cx</option>
                        <option value="pct">pct</option>
                        <option value="dz">dz</option>
                    </select>
                    <div class="input-price-wrapper" style="position: relative; display: flex; align-items: center;">
                        <span class="input-price-symbol" style="position: absolute; left: 10px; color: #888; font-size: 1rem; pointer-events: none;">R$</span>
                        <input id="item-price-input" type="number" min="0" step="0.01" placeholder="Valor" style="padding-left: 2.2em; width: 90px;">
                    </div>
                </div>
                <select id="category-select">
                    <option value="">Categoria</option>
                    <option value="frutas">üçé Frutas</option>
                    <option value="verduras">ü•¨ Verduras</option>
                    <option value="carnes">ü•© Carnes</option>
                    <option value="latic√≠nios">ü•õ Latic√≠nios</option>
                    <option value="padaria">üçû Padaria</option>
                    <option value="limpeza">üßΩ Limpeza</option>
                    <option value="higiene">üß¥ Higiene</option>
                    <option value="bebidas">ü•§ Bebidas</option>
                    <option value="outros">üì¶ Outros</option>
                </select>
                <button id="add-item-btn" title="Adicionar (Enter)">+</button>
            </section>

            <section id="stats-section" class="stats-section">
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-value" id="total-items">0</span>
                        <span class="stat-label">Itens</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="completed-items">0</span>
                        <span class="stat-label">Comprados</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="total-value">R$ 0,00</span>
                        <span class="stat-label">Valor Previsto</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="realized-value">R$ 0,00</span>
                        <span class="stat-label">Valor Realizado</span>
                    </div>
                </div>
            </section>

            <section id="smart-suggestions" class="suggestions-section">
                <h3>üí° Sugest√µes</h3>
                <div id="suggestions-list"></div>
            </section>

            <section id="current-list-section" class="current-list-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h3>üõí Minha Lista de Compras</h3>
                    <div style="display: flex; gap: 0.5rem;">
                        <button id="finish-purchase-btn" class="header-btn primary" title="Finalizar compra e gerar relat√≥rio" style="background-color: #4CAF50; color: white;">
                            ‚úÖ Finalizar Compra
                        </button>
                        <button id="clear-all-btn" class="header-btn" title="Limpar lista">üóëÔ∏è</button>
                    </div>
                </div>
                <ul id="shopping-list"></ul>
            </section>
        </section>
        <!-- Templates Section -->
        <section id="section-templates" class="content-section">
            <header class="section-header">
                <h1>üìã Templates de Lista</h1>
                <button id="create-template-btn" class="header-btn primary" title="Criar novo template">+ Novo</button>
            </header>

            <div class="templates-grid">
                <button class="template-btn" data-template="compra-mes">
                    <span class="template-icon">üõí</span>
                    <span class="template-name">Compra do M√™s</span>
                    <span class="template-count">15 itens</span>
                </button>
                <button class="template-btn" data-template="feira">
                    <span class="template-icon">ü•¨</span>
                    <span class="template-name">Feira Livre</span>
                    <span class="template-count">8 itens</span>
                </button>
                <button class="template-btn" data-template="limpeza">
                    <span class="template-icon">üßΩ</span>
                    <span class="template-name">Produtos de Limpeza</span>
                    <span class="template-count">6 itens</span>
                </button>
                <button class="template-btn" data-template="churrasco">
                    <span class="template-icon">üçñ</span>
                    <span class="template-name">Churrasco</span>
                    <span class="template-count">12 itens</span>
                </button>
                <button class="template-btn" data-template="cafe-manha">
                    <span class="template-icon">‚òï</span>
                    <span class="template-name">Caf√© da Manh√£</span>
                    <span class="template-count">5 itens</span>
                </button>
                <button class="template-btn" data-template="favoritos">
                    <span class="template-icon">‚≠ê</span>
                    <span class="template-name">Meus Favoritos</span>
                    <span class="template-count">20 itens</span>
                </button>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="section-analytics" class="content-section">
            <header class="section-header">
                <h1>üìä Relat√≥rios Comparativos</h1>
                <div class="section-header-controls">
                    <select id="analytics-period" class="header-select">
                        <option value="week">Esta semana</option>
                        <option value="month">Este m√™s</option>
                        <option value="quarter">√öltimos 3 meses</option>
                    </select>
                    <div class="header-actions">
                        <button id="export-png-report-btn" class="header-btn" title="Exportar como Imagem PNG">
                            ÔøΩÔ∏è PNG
                        </button>
                        <button id="export-pdf-report-btn" class="header-btn" title="Exportar como PDF">
                            ÔøΩ PDF
                        </button>
                        <button id="show-improvement-tips-btn" class="header-btn" title="Dicas de Economia">
                            ÔøΩ Dicas
                        </button>
                    </div>
                </div>
            </header>

            <!-- Filtro por Supermercado -->
            <div class="supermarket-filter">
                <select id="supermarket-filter" class="filter-select">
                    <option value="all">Todos os supermercados</option>
                    <option value="pao-de-acucar">P√£o de A√ß√∫car</option>
                    <option value="carrefour">Carrefour</option>
                    <option value="extra">Extra</option>
                    <option value="walmart">Walmart</option>
                </select>
                <small class="filter-hint">Compare pre√ßos entre diferentes mercados</small>
            </div>

            <div class="analytics-grid-minimal">
                <!-- Card Principal de Economia -->
                <div class="analytics-card primary-card">
                    <h3>üí∞ Total de Gastos</h3>
                    <div class="savings-summary">
                        <span class="savings-amount" id="total-savings">R$ 0,00</span>
                        <span class="savings-desc">Nenhuma compra registrada</span>
                        <div class="savings-comparison">
                            <span class="comparison-item">
                                <span class="comparison-label">Seu gasto no per√≠odo:</span>
                                <span class="comparison-value" id="monthly-spending">R$ 0,00</span>
                            </span>
                            <span class="comparison-item">
                                <span class="comparison-label">Finalize compras para ver relat√≥rios</span>
                                <span class="comparison-value">--</span>
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Compara√ß√£o de Supermercados -->
                <div class="analytics-card supermarket-comparison">
                    <h3>ÔøΩ Ranking de Pre√ßos</h3>
                    <div id="supermarket-ranking" class="ranking-container">
                        <div class="no-data">Nenhuma compra com supermercado informado</div>
                    </div>
                </div>

                <!-- Top Itens com Melhor Pre√ßo -->
                <div class="analytics-card top-deals">
                    <h3>üéØ Melhores Pre√ßos por Item</h3>
                    <div id="best-prices-items" class="deals-container">
                        <div class="deal-item">
                            <span class="item-emoji">ü•õ</span>
                            <div class="item-details">
                                <span class="item-name">Leite Integral 1L</span>
                                <span class="best-price">R$ 4,99 <small>no Atacad√£o</small></span>
                            </div>
                            <span class="savings">-R$ 1,50</span>
                        </div>
                        <div class="deal-item">
                            <span class="item-emoji">üçû</span>
                            <div class="item-details">
                                <span class="item-name">P√£o de Forma</span>
                                <span class="best-price">R$ 3,79 <small>no Walmart</small></span>
                            </div>
                            <span class="savings">-R$ 0,90</span>
                        </div>
                        <div class="deal-item">
                            <span class="item-emoji">üçå</span>
                            <div class="item-details">
                                <span class="item-name">Banana Nanica kg</span>
                                <span class="best-price">R$ 2,99 <small>no Extra</small></span>
                            </div>
                            <span class="savings">-R$ 1,20</span>
                        </div>
                    </div>
                </div>

                <!-- Insights Essenciais -->
                <div class="analytics-card insights-minimal">
                    <h3>üí° Insight Principal</h3>
                    <div id="main-insight" class="insight-highlight">
                        <div class="insight-message">
                            Comprando no <strong>Atacad√£o</strong> voc√™ economizaria 
                            <strong>R$ 45,20/m√™s</strong> na sua lista atual
                        </div>
                        <div class="insight-action">
                            üìç Localizar no mapa ‚Ä¢ üîî Ativar alertas de pre√ßo
                        </div>
                    </div>
                </div>
            </div>
        </section>
        </section>

        <!-- History Section -->
        <section id="section-history" class="content-section">
            <header class="section-header">
                <h1>üìÖ Hist√≥rico de Compras</h1>
                <button id="clear-history-btn" class="header-btn danger" title="Limpar hist√≥rico">Limpar</button>
            </header>

            <div class="history-timeline">
                <div class="history-item">
                    <div class="history-date">
                        <span class="history-day">Hoje</span>
                        <span class="history-time">14:30</span>
                    </div>
                    <div class="history-content">
                        <h4>Lista de Compras</h4>
                        <p>15 itens ‚Ä¢ R$ 87,50 ‚Ä¢ Supermercado Extra</p>
                        <span class="history-status completed">Conclu√≠da</span>
                    </div>
                </div>

                <div class="history-item">
                    <div class="history-date">
                        <span class="history-day">Ontem</span>
                        <span class="history-time">09:15</span>
                    </div>
                    <div class="history-content">
                        <h4>Feira Livre</h4>
                        <p>8 itens ‚Ä¢ R$ 35,20 ‚Ä¢ Feira da Liberdade</p>
                        <span class="history-status completed">Conclu√≠da</span>
                    </div>
                </div>

                <div class="history-item">
                    <div class="history-date">
                        <span class="history-day">3 dias</span>
                        <span class="history-time">16:45</span>
                    </div>
                    <div class="history-content">
                        <h4>Produtos de Limpeza</h4>
                        <p>6 itens ‚Ä¢ R$ 42,80 ‚Ä¢ Drogasil</p>
                        <span class="history-status completed">Conclu√≠da</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Supermarkets Section -->
        <section id="section-supermarkets" class="content-section">
            <header class="section-header">
                <h1>üè™ Supermercados</h1>
                <button id="add-supermarket-btn" class="header-btn primary" title="Adicionar supermercado">+ Adicionar</button>
            </header>

            <div class="supermarkets-container">
                <!-- Seletor de supermercado atual -->
                <div class="current-supermarket">
                    <h3>Supermercado Atual</h3>
                    <select id="current-supermarket-select" class="supermarket-selector">
                        <option value="">Selecione um supermercado</option>
                    </select>
                    <p class="supermarket-info">Selecione onde voc√™ est√° fazendo suas compras</p>
                </div>

                <!-- Lista de supermercados cadastrados -->
                <div class="supermarkets-list">
                    <h3>Supermercados Cadastrados</h3>
                    <div id="supermarkets-grid" class="supermarkets-grid">
                        <!-- Os supermercados ser√£o carregados dinamicamente aqui -->
                    </div>
                </div>
            </div>

            <!-- Modal para adicionar/editar supermercado -->
            <div id="supermarket-modal" class="modal supermarket-modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="supermarket-modal-title">Adicionar Supermercado</h3>
                        <button class="modal-close" onclick="closeSupermarketModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="supermarket-form">
                            <div class="form-group">
                                <label for="supermarket-name">Nome do Supermercado*</label>
                                <input type="text" id="supermarket-name" required placeholder="Ex: P√£o de A√ß√∫car">
                            </div>
                            <div class="form-group">
                                <label for="supermarket-location">Localiza√ß√£o</label>
                                <input type="text" id="supermarket-location" placeholder="Ex: Shopping Center Norte">
                            </div>
                            <div class="form-group">
                                <label for="supermarket-type">Tipo</label>
                                <select id="supermarket-type">
                                    <option value="supermercado">Supermercado</option>
                                    <option value="hipermercado">Hipermercado</option>
                                    <option value="atacado">Atacado</option>
                                    <option value="mercearia">Mercearia</option>
                                    <option value="feira">Feira</option>
                                    <option value="farmacia">Farm√°cia</option>
                                    <option value="conveniencia">Conveni√™ncia</option>
                                    <option value="outro">Outro</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="supermarket-notes">Observa√ß√µes</label>
                                <textarea id="supermarket-notes" placeholder="Ex: Melhores pre√ßos em produtos de limpeza"></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn-secondary" onclick="closeSupermarketModal()">Cancelar</button>
                        <button type="submit" form="supermarket-form" class="btn-primary">Salvar</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="section-settings" class="content-section">
            <header class="section-header">
                <h1>‚öôÔ∏è Configura√ß√µes</h1>
            </header>

            <div class="settings-groups">
                <div class="settings-group">
                    <h3>Notifica√ß√µes</h3>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="notifications-enabled" checked>
                            <span>Ativar notifica√ß√µes</span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="smart-reminders" checked>
                            <span>Lembretes inteligentes</span>
                        </label>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Funcionalidades</h3>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="smart-suggestions-enabled" checked>
                            <span>Sugest√µes inteligentes</span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="price-tracking-enabled" checked>
                            <span>Rastreamento de pre√ßos</span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="auto-category-enabled" checked>
                            <span>Categoriza√ß√£o autom√°tica</span>
                        </label>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Dados e Privacidade</h3>
                    <div class="setting-item">
                        <button id="export-data-btn" class="settings-btn">Exportar dados</button>
                    </div>
                    <div class="setting-item">
                        <button id="import-data-btn" class="settings-btn">Importar dados</button>
                    </div>
                    <div class="setting-item">
                        <button id="clear-data-btn" class="settings-btn danger">Limpar todos os dados</button>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Sobre</h3>
                    <div class="about-info">
                        <p><strong>Listou</strong> v2.0</p>
                        <p>Lista de compras inteligente</p>
                        <p>Desenvolvido por Rafael Ara√∫jo </p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Overlay for mobile sidebar -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>

    <script src="db.js" type="module"></script>
    <script src="qr.js" type="module"></script>
    <script src="intelligence.js" type="module"></script>
    <script src="analytics.js" type="module"></script>
    <script src="notifications.js" type="module"></script>
    <script src="app.js" type="module"></script>
    <!-- Script para dados de demonstra√ß√£o - remover em produ√ß√£o -->
    <script src="supermarket-demo-data.js"></script>
</body>
</html>
